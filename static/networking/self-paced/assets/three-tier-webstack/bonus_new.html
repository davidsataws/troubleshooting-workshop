<!DOCTYPE html>
<html lang="en">
<head>
<title>AWS Support Troubleshooting Workshop</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/ico" href="https://a0.awsstatic.com/main/images/site/fav/favicon.ico">
<style>
* {{
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}}
body {{
  font-family: "Amazon Ember", "Helvetica Neue", Roboto, Arial, sans-serif;
  background: #eaeded;
  color: #16191f;
  line-height: 1.5;
}}
.aws-header {{
  background: #232f3e;
  color: white;
  padding: 16px 24px;
  border-bottom: 4px solid #ff9900;
}}
.aws-header h1 {{
  font-size: 20px;
  font-weight: 400;
}}
.container {{
  max-width: 1200px;
  margin: 0 auto;
  padding: 32px 24px;
}}
.page-header {{
  background: white;
  padding: 24px;
  margin-bottom: 24px;
  border-left: 4px solid #ff9900;
  box-shadow: 0 1px 1px rgba(0,0,0,0.1);
}}
.page-header h2 {{
  font-size: 28px;
  font-weight: 300;
  margin-bottom: 8px;
}}
.page-header p {{
  color: #545b64;
}}
.test-grid {{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 16px;
  margin-top: 24px;
}}
.test-card {{
  background: white;
  border: 1px solid #d5dbdb;
  border-radius: 2px;
  padding: 20px;
  transition: box-shadow 0.2s;
}}
.test-card:hover {{
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}}
.test-card h3 {{
  font-size: 18px;
  font-weight: 400;
  margin-bottom: 16px;
  color: #16191f;
}}
.test-status {{
  font-size: 16px;
  font-weight: 700;
  margin: 12px 0;
}}
.w3-text-green {{
  color: #1d8102;
}}
.w3-text-red {{
  color: #d13212;
}}
.test-metric {{
  color: #545b64;
  font-size: 14px;
  margin: 8px 0;
}}
.aws-button {{
  background: #ff9900;
  color: #16191f;
  border: none;
  padding: 10px 20px;
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  border-radius: 2px;
  margin-top: 12px;
  transition: background 0.2s;
}}
.aws-button:hover {{
  background: #ec7211;
}}
.aws-button-secondary {{
  background: white;
  color: #16191f;
  border: 1px solid #aab7b8;
  padding: 10px 20px;
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  border-radius: 2px;
  transition: all 0.2s;
}}
.aws-button-secondary:hover {{
  background: #fafafa;
  border-color: #16191f;
}}
.modal {{
  display: none;
  position: fixed;
  top: 0;
  left: 0;

  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  z-index: 1000;
}}
.modal-content {{
  background: white;
  max-width: 600px;
  margin: 80px auto;
  border-radius: 2px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  position: relative;
}}
.modal-header {{
  background: #232f3e;
  color: white;
  padding: 20px 24px;
  border-bottom: 2px solid #ff9900;
  position: relative;
}}
.modal-header h3 {{
  font-size: 20px;
  font-weight: 400;
}}
.modal-close {{
  position: absolute;
  top: 16px;
  right: 20px;
  color: white;
  font-size: 28px;
  cursor: pointer;
  opacity: 0.8;
  line-height: 1;
}}
.modal-close:hover {{
  opacity: 1;
}}
.modal-body {{
  padding: 24px;
  color: #16191f;
}}
.modal-body a {{
  color: #0073bb;
  text-decoration: none;
}}
.modal-body a:hover {{
  text-decoration: underline;
}}
</style>
</head>
<body>

<div class="aws-header" style="display: flex; justify-content: space-between; align-items: center;">
  <h1>AWS Support Troubleshooting Workshop</h1>
  <img src="https://d0.awsstatic.com/logos/powered-by-aws-white.png" alt="Powered by AWS" style="height: 40px;">
</div>

<div class="container">
  <div class="page-header">
    <h2>Bonus Exercises - Web Server Diagnostics</h2>
    <p>Test the connectivity and health of various AWS services and dependencies</p>
    <button class="aws-button-secondary" onclick="document.getElementById('helpModal').style.display='block'" style="margin-top: 16px;">View Instructions</button>
  </div>

  <div class="test-grid">
    <div class="test-card">
      <img src="https://github.com/davidsataws/troubleshooting-workshop/raw/main/static/networking/self-paced/assets/three-tier-webstack/external_dependency_logo.png" alt="" style="width: 48px; margin-bottom: 12px;">
      <h3>API TCP Connectivity</h3>
      <div class="test-status">{APITestString}</div>
      <div class="test-metric">Response time: {APITime} ms</div>
      <button class="aws-button" onclick="document.getElementById('apiModal').style.display='block'">Details</button>
    </div>

    <div class="test-card">
      <img src="https://github.com/davidsataws/troubleshooting-workshop/raw/main/static/networking/self-paced/assets/three-tier-webstack/external_dependency_logo.png" alt="" style="width: 48px; margin-bottom: 12px;">
      <h3>API HTTP Health</h3>
      <div class="test-status">{APIHTTPTestString}</div>
      <div class="test-metric">Response time: {APIHttpTime} ms</div>
      <button class="aws-button" onclick="document.getElementById('apiHttpModal').style.display='block'">Details</button>
    </div>

    <div class="test-card">
      <img src="https://github.com/davidsataws/troubleshooting-workshop/raw/main/static/networking/self-paced/assets/three-tier-webstack/cloudwatch.png" alt="" style="width: 48px; margin-bottom: 12px;">
      <h3>CloudWatch Canary</h3>
      <div class="test-status">{CanaryTestString}</div>
      <div class="test-metric">Response time: {CanaryTime} ms</div>
      <button class="aws-button" onclick="document.getElementById('canaryModal').style.display='block'">Details</button>
    </div>

    <div class="test-card">
      <img src="https://github.com/davidsataws/troubleshooting-workshop/raw/main/static/networking/self-paced/assets/three-tier-webstack/admin.png" alt="" style="width: 48px; margin-bottom: 12px;">
      <h3>Admin Site Test</h3>
      <div class="test-status">{AdminTestString}</div>
      <div class="test-metric">Response time: {AdminTime} ms</div>
      <button class="aws-button" onclick="document.getElementById('adminModal').style.display='block'">Details</button>
    </div>
  </div>
</div>

<div id="helpModal" class="modal" onclick="if(event.target==this) this.style.display='none'">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Workshop Instructions</h3>
      <span class="modal-close" onclick="document.getElementById('helpModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
      <p><strong>Follow the Workshop Page for step-by-step guidance, hints and tips.</strong></p>
      <p style="margin-top: 12px;">The tests on this webpage indicate which dependencies are functioning correctly within the webserver code.</p>
      <p style="margin-top: 12px;">Your task is to find out why some are failing and to fix them, without changing code on the webserver.</p>
      <p style="margin-top: 16px; color: #1d8102; font-weight: 700;">Congratulations on getting to the bonus exercises - Good Luck!</p>
    </div>
  </div>
</div>

<div id="apiModal" class="modal" onclick="if(event.target==this) this.style.display='none'">
  <div class="modal-content">
    <div class="modal-header">
      <h3>API TCP Connectivity Test</h3>
      <span class="modal-close" onclick="document.getElementById('apiModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
      <p>This test calls the API server (rsapi.supportworkshopapi.com) in the TGW-peered VPC. It requires the appropriate network routing for traffic from the webapp VPC to the API VPC.</p>
    </div>
  </div>
</div>

<div id="apiHttpModal" class="modal" onclick="if(event.target==this) this.style.display='none'">
  <div class="modal-content">
    <div class="modal-header">
      <h3>API HTTP Health Test</h3>
      <span class="modal-close" onclick="document.getElementById('apiHttpModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
      <p>This test calls the API server (rsapi.supportworkshopapi.com) in the TGW-peered VPC. It requires the appropriate network routing for traffic from the webapp VPC to the API VPC. It also requires the API server to be running and for the request to successfully pass through the firewall.</p>
    </div>
  </div>
</div>

<div id="canaryModal" class="modal" onclick="if(event.target==this) this.style.display='none'">
  <div class="modal-content">
    <div class="modal-header">
      <h3>CloudWatch Canary Test</h3>
      <span class="modal-close" onclick="document.getElementById('canaryModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
      <p>This test indicates the status of the <a href="https://us-east-1.console.aws.amazon.com/cloudwatch/home?region=us-east-1#synthetics:/canary/detail/webapp-canary" target="_blank">CloudWatch Synthetics Canary</a> for the URL: http://{WebappDNS}/canary</p>
    </div>
  </div>
</div>

<div id="adminModal" class="modal" onclick="if(event.target==this) this.style.display='none'">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Admin Site Test</h3>
      <span class="modal-close" onclick="document.getElementById('adminModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
      <p>This test calls http://{WebappDNS}/admin and should be sent to the appropriate admin webservers.</p>
    </div>
  </div>
</div>

</body>
</html>
